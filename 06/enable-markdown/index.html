<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><InfinitySpiritMetaTitle>markdownでブログを書けるようにした</InfinitySpiritMetaTitle></title>
    <link rel="stylesheet" href="../../InfinitySpirit/template/style.css" />
    <script defer src="../../InfinitySpirit/template/script.js"></script>
    <link rel="stylesheet" href="/The-Infinitys-Infinity/style.css">
    <script defer src="/The-Infinitys-Infinity/script.js"></script>
  </head>
  <body>
    <div class="article-body">
      <div class="article-title">
        <InfinitySpiritArticleTitle>markdownでブログを書けるようにした</InfinitySpiritArticleTitle>
        <br />
        <svg
          class="clock-watch"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          viewbox="0 0 100 100"
          stroke="#888"
          fill="none"
          stroke-width="5"
          stroke-linecap="round">
          <g class="Infinity-clock_frame">
            <circle cx="50" cy="50" r="40" />
          </g>
          <g class="Infinity-clock_hands">
            <path d="M50 50,L50 20 Z" />
            <path d="M50 50,L70 70 Z" />
          </g>
        </svg>
        <InfinitySpiritDate></InfinitySpiritDate>
      </div>
      <div class="article-content">
        <InfinitySpiritContent>
          <h2 id="html">余りにも面倒だったhtml</h2>
          <p>どうもどうも! The Infinitysです!<br />
          最近blogを書いていて、思ったことがあるんですよね&hellip;</p>
          <p>「いちいちhtmlで書くのは面倒臭いな&hellip;(´・ω・)」</p>
          <p>と。それでも今日までずっとhtmlで書いてきて慣れていたので、まあいっかって思ったんです。ですが私の友人の人子がきっかけでその考えは変わりました。</p>
          <p>「markdownでblogを書きたい」</p>
          <p>その時私の何かがフツッと切れ、次の瞬間にはキーボードをばちばち叩く私の姿が٩( ᐛ )وやっぱりhtmlで書くのは面倒くさい！</p>
          <p>そう言うわけで、私はhtmlで書くのをやめたいと思いました。これからはブログは全てmarkdown経由で書きます。</p>
          <h2 id="_1">どうやってやったのか</h2>
          <p>私も一プログラマですので、自分のやりたい事くらいは自分でできなければメンタルが持ちません。そう言うわけでググりながら調べまわりました。<br />
          markdownで書くうえで一切htmlを経由せずに書けるように、プログラムで自動化しました。まずは、pythonでスクリプトを書きます。</p>
          <h4 id="markdown-converterpy">markdown-converter.pyのソースコード</h4>
          <pre class="codehilite"><code class="language-python">import datetime
          import os
          import markdown
          from sys import exit
          article_temp_head='''
          &lt;!DOCTYPE html&gt;
          &lt;html lang=&quot;Ja&quot;&gt;
            &lt;head&gt;
              &lt;meta charset=&quot;UTF-8&quot; /&gt;
                  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;&lt;meta name=&quot;description&quot; content=&quot;The Infinity's awesome blog article&quot; /&gt;
              &lt;title&gt;HERE TO THE TITLE&lt;/title&gt;
              &lt;link rel=&quot;stylesheet&quot; href=&quot;../../Infinity-style/style.css&quot; /&gt;
              &lt;script defer src=&quot;../../Infinity-style/script.js&quot;&gt;&lt;/script&gt;
            &lt;script defer src=&quot;/The-Infinitys-Infinity/script.js&quot;&gt;&lt;/script&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/The-Infinitys-Infinity/style.css&quot; /&gt;
              &lt;script
              defer
              src=&quot;https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2045274771035552&quot;
              crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;&lt;/head&gt;
            &lt;body&gt;&lt;div id=&quot;article-body&quot;&gt;&lt;div id=&quot;article-content&quot;&gt;
          '''
          article_temp_foot='''
            &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;
          &lt;/html&gt;
          '''
          def listfolders(dir_path):
            result = [
                f for f in os.listdir(dir_path) if os.path.isdir(os.path.join(dir_path, f))
            ]
            return result
          def listfiles(dir_path):
            result = [
                f for f in os.listdir(dir_path) if os.path.isfile(os.path.join(dir_path, f))
            ]
            return result
          now=datetime.datetime.now()
          now=str(now.year)+&quot;-&quot;+str(now.month)
          root_dir=&quot;./&quot;+now
          def renew():
            os.system(&quot;git config user.name github-actions&quot;)
            os.system(&quot;git config user.email github-actions@github.com&quot;)
            os.system(&quot;git add .&quot;)
            os.system(&quot;git commit -m \&quot;convert markdown\&quot;&quot;)
            os.system(&quot;git push&quot;)
          if not os.path.isdir(root_dir):
            print(&quot;No datas&quot;)
            exit()
          for article_dir in listfolders(root_dir):
            path = root_dir+&quot;/&quot;+article_dir
            file_names = listfiles(path)
            index_path = None
            article_path=None
            for file_name in file_names:
              if file_name.startswith(&quot;index&quot;):
                index_path=file_name
              elif file_name==(&quot;article.md&quot;):
                article_path=file_name
            if article_path!=None:
              markdown_text = &quot;&quot;
              markdown_title = &quot;&quot;
              with open(root_dir+&quot;/&quot;+article_dir+&quot;/&quot;+article_path,mode=&quot;r&quot;) as f:
                markdown_text = f.read()
                f.close()
              markdown_result = &quot;&quot;
              for markdown_line in markdown_text.split(&quot;\n&quot;):
                if markdown_line.startswith(&quot;# title: &quot;):
                  markdown_title=markdown_line[8:]
                else:
                  markdown_result+=markdown_line+&quot;\n&quot;
              html_text=markdown.markdown(markdown_result)
              html_result=&quot;&quot;
              for html_line in html_text.split(&quot;\n&quot;):
                html_result+=&quot; &quot;*4+html_line+&quot;\n&quot;
              if index_path!=None:
                os.system(&quot;rm &quot;+root_dir+&quot;/&quot;+article_dir+&quot;/&quot;+index_path)
              with open(root_dir+&quot;/&quot;+article_dir+&quot;/index.html&quot;,mode=&quot;w&quot;) as f:
                f.write(article_temp_head.replace(&quot;HERE TO THE TITLE&quot;,markdown_title)+html_result+article_temp_foot)
                f.close()
          renew()
          </code></pre>
          
          <p>これだけのプログラムを自力で書きました&hellip;(´・ω・)ある程度(リポジトリの更新とファイル・フォルダ構造の解析)はapiのプログラムから流用が効いたのですが&hellip;こんなことをするのは恐らく私が初めてみたいで、参考になるような情報は一切合切手に入りませんでした。<br />
          そして次に、github actionsのyamlファイルを書きました。</p>
          <h4 id="yaml">yamlファイルの方</h4>
          <p><code>github actions
          name: The-Infinitys_Blog-markdown
          run-name: converting markdown
          on: push
          jobs:
            markdown-convert:
              permissions:
                repository-projects: write
                contents: write
              runs-on: ubuntu-latest
              steps:
                - uses: actions/checkout@v4
                - run: git pull
                - run: pip install markdown
                - run: python ./programs/markdown-converter.py</code><br />
          こっちのyamlファイルはがっつりapiから流用できたので苦でもありませんでした。</p>
          <h2 id="_2">やってみた感想</h2>
          <p>激ムズすぎて二度とやりたくないです(´・ω・)<br />
          <date>2024/06/13</date></p>

          </InfinitySpiritContent>
      </div>
      <div class="article-index"></div>
      <div class="articles-recommended"></div>
    </div>
  </body>
</html>
